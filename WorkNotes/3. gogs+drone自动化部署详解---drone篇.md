# drone
## 什么是drone
> Drone 是一个基于 Docker 的云原生的持续集成/部署工具,能支持四种 git 托管服务（github, gitlab, gogs, gitea) 而 drone-server 预先知晓了对应托管服务的 API，drone 的很多功能比如拉取 git repo list/add webhook to repo 都是通过这些 API 完成的。

## 前期准备
首先准备好服务器（也可以本地搭建），其次了解一些基础的docker操作和linux命令。因为此次是基于阿里云服务器进行，所以本地搭建不做介绍。此外会从纯linux+docker搭建和宝塔linux面板搭建两种方式进行介绍。

- 服务器： 阿里云（1核2G） centOS 7.7.1908
- mysql：5.7 （5.7及以上，低版本会产生gogs报错主索引长度不够 Specified key was too long; max key length is 764 bytes  ）
- drone/agent:1.0.0-rc.5
- drone/drone:1.0.0-rc.5

ps:首先要对drone-server 和 drone-agent 有个感性的认知，大概了解它们的职责。比如 .drone.yml 的 parsing 发生在 drone-server，具体的 steps 跑在 drone-agent. 这样很容易推理出 environment/build_args关键字是不影响 .drone.yml 文件本身环境变量的解析替换。

## 安装drone


- `main: local build runner disabled`:
> 

- 修改docker时区不对，初始化的时候增加两个挂载
```
/etc/timezone:/etc/timezone
/etc/localtime:/etc/localtime 
```



